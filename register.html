<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Register - KasunAkalanka | GhostDevKA</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      text-decoration: none;
      border: none;
      outline: none;
      scroll-behavior: smooth;
      font-family: "Quicksand", sans-serif;
      font-weight: 700;
    }
    :root {
    --bg-color: rgba(31, 36, 45);
    --second-bg-color: rgba(50, 57, 70);
    --text-color: #fff;
    --main-color: rgba(255, 128, 0);
    --main-color-darken: rgba(255, 128, 0, 0.5);
    --btn-txt: rgba(50, 57, 70);
    --header-bg: rgba(0, 0, 0, 0.4);
    --header-tx: #fff;
}

.light-theme {
    --bg-color: rgba(96, 129, 200, 0.83);  
    --second-bg-color: rgba(208, 230, 255);     
    --text-color: rgba(30, 41, 59); 
    --main-color: rgba(218, 119, 53);
    --main-color-darken: rgba(218, 119, 53, 0.5);
    --btn-txt: rgba(255, 255, 255);
    --header-bg: rgba(0, 0, 0, 0.7);
    --header-tx: #fff;
}
    html {
      font-size: 62.5%;
      overflow-x: hidden;
    }

    body {
        background: var(--bg-color);
        color: var(--text-color);
    }

    #bg-video {
      position: fixed;
      top: 0;
      left: 0;
      min-width: 100%;
      min-height: 100%;
      object-fit: cover;
      z-index: -1; /* Send it behind all other elements */
      opacity: 0.35; /* Optional: for a subtle background look */
    }

    .container {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
      background-color: rgba(255,255,255,0.2);
      padding: 38px 40px 32px 40px; /* More padding at bottom */
      border-radius: 18px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.13);
      width: 370px;
      min-height: 5vh;
      text-align: center;
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    h2 {
      color: var(--text-color);
      font-size: 3rem;
      margin-bottom: 1.5rem;
    }

    input[type="text"], input[type="password"] {
      width: 270px;;
      padding:12px 15px;
      margin:10px 0;
      border:1px solid #ced4da;
      border-radius:8px;
      box-sizing:border-box;
      transition:border-color 0.3s ease;
      font-size:15px;
    }
    button[type="submit"] {
      background-color: var(--main-color);
      color:white;
      padding:12px;
      width:100%;
      border:none;
      border-radius:8px;
      cursor:pointer;
      font-weight:bold;
      margin-top:15px;
      font-size:16px;
      transition:background-color 0.3s ease;
    }
    button[type="submit"]:hover {
      background-color: var(--main-color);
    }
    a {
      color: var(--main-color);
      text-decoration: none;
      font-size: 1.7rem;
      font-weight: 700;
      font-style: bold;
    }
    a:hover {
      text-decoration: underline;
    }
    .links {
      margin-top: 20px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
    }
    p {
      color: var(--text-color);
      font-size: 1.7rem;
      margin: 0;
    }

    .background {
      min-height: 90vh;
    }

    .footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    padding: 2rem 9%;
    background: var(--second-bg-color);
}

.footer-text p {
    font-size: 1.6rem;
}
</style>
</head>
<body>

  <video autoplay muted loop playsinline id="bg-video">
  <source src="assets/bgvid.mp4" type="video/mp4" />
  Your browser does not support the video tag.
  </video>

<div class="background">
<div class="container">
  <h2>Register</h2>
  <form id="registerForm" style="display: flex; flex-direction: column;">
    <input type="text" id="name" placeholder="Name" required>
    <input type="text" id="email" placeholder="Email" required>
    <input type="text" id="phone" placeholder="Phone">
    <input type="password" id="password" placeholder="Password" required>
    <button type="submit">Register</button>
  </form>
  <div class="message" id="message"></div>
  <div class="links">
    <p>
      Already have an account?
      <a href="login.html">Login</a>
    </p>
    <p>
      <a href="index.html">Back to Home Page</a>
    </p>
  </div>
</div></div>

<!-- footer design -->
         <footer class="footer">
          <div class="footer-text">
            <p>Copyright &copy; <span id="year"></span> GhostDevKA | All Rights Reserved.</p>
          </div>

         </footer>



<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCvjAHVlwSIPrPjT3DOtF00GL_5MI-vYxc",
    authDomain: "kasunakalanka-web.firebaseapp.com",
    projectId: "kasunakalanka-web"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  const form = document.getElementById("registerForm");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const name = document.getElementById("name").value;
    const email = document.getElementById("email").value;
    const phone = document.getElementById("phone").value;
    const password = document.getElementById("password").value;

    try {
      // Create user in Firebase
      const userCred = await auth.createUserWithEmailAndPassword(email, password);
      const token = await userCred.user.getIdToken(true); // üîÅ force fresh token

      // Save profile to your backend
      const response = await fetch("https://kasunakalanka-web-backend.onrender.com/api/users/register", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: `Bearer ${token}`,
        },
        body: JSON.stringify({ name, email, phone }),
      });

      if (!response.ok) {
        const text = await response.text();
        throw new Error("Registration failed: " + text);
      }

      alert("Registration successful!");
      window.location.href = "login.html";

    } catch (error) {
      alert(error.message);
      console.error(error);
    }
  });

      /*================ theme toggle =============== */
var themeIcon = document.getElementById('theme-toggle');

// Apply saved theme on page load
if (localStorage.getItem('theme') === 'light') {
    document.body.classList.add("light-theme");
    themeIcon.classList.remove('bx-moon');
    themeIcon.classList.add('bx-sun');
}

</script>




</body>
</html>
